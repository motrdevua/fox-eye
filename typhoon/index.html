<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="utf-8" />
    <title>FOX-EYE v0.1 (Pre-release)</title>
    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' stroke='%2300ff00' stroke-width='5' fill='none'/><line x1='50' y1='5' x2='50' y2='95' stroke='%2300ff00' stroke-width='2'/><line x1='5' y1='50' x2='95' y2='50' stroke='%2300ff00' stroke-width='2'/></svg>"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./app.css" />

    <script src="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mgrs@1.0.0/dist/mgrs.min.js"></script>
    <script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>
    <script>
      const icons = {
        launch: `<svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor" style="margin-right:8px"><path d="M12,2L4.5,20.29L5.21,21L12,18L18.79,21L19.5,20.29L12,2Z"/></svg>`,
        reset: `<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" style="margin-right:8px"><path d="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"/></svg>`,
        clear: `<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" style="margin-right:8px"><path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19V4M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"/></svg>`,
        ruler: `<svg viewBox="0 0 24 24"><path d="M7,2H17A2,2 0 0,1 19,4V20A2,2 0 0,1 17,22H7A2,2 0 0,1 5,20V4A2,2 0 0,1 7,2M7,4V6H10V8H7V10H12V12H7V14H10V16H7V18H12V20H17V4H7Z"/></svg>`,
        compass: `<svg viewBox="0 0 24 24"><path d="M12,2A1,1 0 0,1 13,3A1,1 0 0,1 12,4A1,1 0 0,1 11,3A1,1 0 0,1 12,2M9.2,5.2L10.5,5.2L11,8.1L11.5,5.2L12.8,5.2L13.3,8.1L13.8,5.2L15.1,5.2L13.6,15H15V17H13.3L12.8,20.2L12.5,22H11.5L11.2,20.2L10.7,17H9V15H10.4L8.9,5.2M12,9L11.5,12H12.5L12,9Z"/></svg>`,
        scan: `<svg viewBox="0 0 24 24"><path d="M14,6L10.25,11L13.1,14.8L11.5,16C9.81,13.75 7,10 7,10L1,18H23L14,6Z"/></svg>`,
        eye: `<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"/></svg>`,
      };
    </script>
  </head>

  <body>
    <div id="search-overlay">
      <div class="search-box">
        <h2 style="margin-top: 0">FOX-EYE</h2>
        <div class="radio-group">
          <input
            type="radio"
            name="search-type"
            id="type-city"
            value="city"
            checked
            onclick="updatePlaceholder()"
          />
          <label for="type-city" class="radio-label">НП</label>
          <input
            type="radio"
            name="search-type"
            id="type-mgrs"
            value="mgrs"
            onclick="updatePlaceholder()"
          />
          <label for="type-mgrs" class="radio-label">MGRS</label>
        </div>
        <input
          type="text"
          id="city-input"
          placeholder="ВВЕДІТЬ НАЗВУ НП..."
          onkeypress="if(event.key==='Enter') performSearch()"
        />
        <br />
        <button class="main-btn" onclick="performSearch()" style="width: auto">
          <script>
            document.write(icons.launch);
          </script>
          ПОШУК
        </button>
      </div>
    </div>

    <div id="map"></div>

    <div class="data-panel" id="map-controls" style="display: none">
      <span class="label-desc">Інструменти</span>
      <div class="ruler-selector">
        <button
          class="icon-btn"
          id="ruler-btn-1"
          onclick="setActiveTool('ruler')"
          title="Лінійка + Час"
        >
          <script>
            document.write(icons.ruler);
          </script>
        </button>
        <button
          class="icon-btn"
          id="ruler-btn-2"
          onclick="setActiveTool('compass')"
          title="Циркуль (Радіус)"
        >
          <script>
            document.write(icons.compass);
          </script>
        </button>

        <button
          class="icon-btn"
          id="ruler-btn-4"
          onclick="setActiveTool('scan')"
          title="Сканер висот (Area Scan)"
        >
          <script>
            document.write(icons.scan);
          </script>
        </button>
      </div>

      <div>
        <span class="label-desc">MGRS</span>
        <span id="mgrs-info" style="font-size: 16px; font-weight: bold"
          >---</span
        >
      </div>

      <div class="hint">
        • Циркуль: 1-й клік центр, 2-й радіус<br />
        • Shift+Click: замір між маркерами
      </div>

      <button class="main-btn" onclick="location.reload()">
        <script>
          document.write(icons.reset);
        </script>
        НОВИЙ ПОШУК
      </button>
    </div>

    <div id="distance-info" class="distance-container" style="display: none">
      ВІДСТАНЬ: 0 м
    </div>

    <div id="results-sidebar" class="results-panel" style="display: none">
      <div class="panel-header">РЕЗУЛЬТАТИ СКАНУВАННЯ</div>
      <div id="points-list" class="points-list"></div>
      <button
        class="main-btn"
        onclick="clearScanResults()"
        style="margin-top: 10px"
      >
        <script>
          document.write(icons.clear);
        </script>
        ОЧИСТИТИ
      </button>
    </div>

    <div id="modal-prompt" class="modal-overlay" style="display: none">
      <div class="modal-content">
        <div class="panel-header" id="modal-prompt-title">ЗАПИТ ДАНИХ</div>
        <div style="padding: 12px">
          <p
            id="modal-prompt-text"
            style="margin-bottom: 15px; color: var(--color-main)"
          ></p>
          <input
            type="text"
            id="modal-prompt-input"
            class="main-input"
            style="width: 100%"
          />
          <div style="display: flex; gap: 10px">
            <button class="main-btn" id="modal-prompt-ok">ПІДТВЕРДИТИ</button>
            <button
              class="main-btn"
              id="modal-prompt-cancel"
              style="background: var(--color-accent); color: white"
            >
              СКАСУВАТИ
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="modal-alert" class="modal-overlay" style="display: none">
      <div class="modal-content">
        <div
          class="panel-header"
          style="color: var(--color-accent); border-color: var(--color-main)"
        >
          УВАГА!
        </div>
        <div style="padding: 20px; text-align: center">
          <p id="modal-alert-text" style="margin-bottom: 20px; color: #fff"></p>
          <button class="main-btn" id="modal-alert-ok">ЗРОЗУМІЛО</button>
        </div>
      </div>
    </div>

    <script src="./app.js"></script>
  </body>
</html>
