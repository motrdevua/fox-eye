# fox-eye

/ (root)
├── index.html
├── css/
│   └── app.css
└── js/
    ├── config.js               # Константи, кольори, налаштування API
    ├── state.js                 # Стан додатку (AppState, current markers)
    ├── map.js                  # Ініціалізація карти (MapLibre)
    ├── utils.js                   # Допоміжні функції (форматування, MGRS)
    ├── dataManager.js    # Імпорт/Експорт файлів
    ├── ui/                         # Все, що стосується інтерфейсу
    │   ├── modals.js        # Логіка модальних вікон
    │   └── notifications.js # Тости та сповіщення
    ├── tools/                    # Інструменти карти
    │   ├── ruler.js             # Лінійка
    │   ├── compass.js      # Компас
    │   └── scanner.js        # Сканер області (FOX-EYE core)
    └── app.js                    # Головний файл (точка входу)

## (Roadmap):

#### 1. Технічна оптимізація та Refactoring

* **Модульність:** Зараз весь JS знаходиться в одному великому файлі `app.js`. Варто розділити його на логічні модулі: `map-engine.js`, `tools.js`, `ui-manager.js`, `markers.js`.
* **Обробка помилок:** Додати перевірку доступності API ключів та обробку 404 помилок при завантаженні тайлів.

#### 2. Нові функції (Feature Ideas)

* **Профіль висот (Elevation Profile):** Оскільки у вас вже підключено `terrain-data`, можна додати побудову графіка перепаду висот вздовж лінії, намальованої "Лінійкою".
* **Розрахунок площі (Area Tool):** Додати інструмент "Полігон" для вимірювання площі ділянки.
* **Імпорт/Експорт:** Можливість зберігати нанесені маркери та лінії у форматі KML/GeoJSON для відкриття в інших програмах (наприклад, у Кропиві чи Google Earth).
* **Офлайн режим:** Кешування тайлів для роботи в умовах поганого зв'язку.
* **Зона видимості (Viewshed):** Розрахунок того, що бачить спостерігач з конкретної точки на основі 3D-рельєфу.

#### 3. Покращення UI/UX

* **Мобільна адаптація:** Покращити керування пальцями (touch events) для інструментів SCAN та Лінійка.
* **Групування маркерів:** Якщо точок багато, вони перекривають одна одну. Можна додати механізм кластеризації.

Важливе зауваження щодо Аналізу Видимості

Функція calculateVisibility все ще використовує map.queryTerrainElevation. Якщо ви хочете, щоб і зони видимості були "професійними", потрібно переписати і її на API-запити. Проте, оскільки там сотні точок на один промінь, це може бути повільно.

* [ ] Чи бажаєш ти додати можливість **автоматичного створення PDF-звіту** , де на першій сторінці буде карта, а на другій — велика таблиця з координатами та відстанями для артилерії чи груп навігації?
* [ ] Чи хочеш ти, щоб я додав у PDF-звіт **QR-код** , який при скануванні відкриватиме цю саму ділянку карти в Google Maps або на іншому пристрої?
* [ ] Чи хочеш ти, щоб я додав у звіт також поточний час друку та азимут (напрямок погляду карти), щоб було легше орієнтувати аркуш на місцевості?
* [ ] Нужно ли нам добавить в отчет "логотип" или название подразделения в верхней части листа?
* [ ] Додати експорт точок у формат KML, щоб їх можна було відкрити в Google Earth чи "Кропиві"?
* [ ] імпортом точок з Excel/CSV?
* [ ] Можемо додати **"Режим прихованого переміщення"** (якщо ти рухаєшся з планшетом, карта автоматично центрується на тобі, але не малює твій трек)?

* **Безпека:** API Key "зашитий" у коді.
* **Залежність:** Покладання на онлайн-тайли (Google, MapTiler, OpenTopoMap). Без інтернету карта не завантажиться (якщо не реалізовано кешування через Service Worker, якого в цьому коді не видно).
* **Структура коду:** Весь JS в одному файлі. Для розширення функціоналу краще було б розбити на модулі.



**1. PWA (Progressive Web App) — Офлайн режим**
Зараз карта залежить від інтернету (тайли, скрипти). Щоб зробити "FOX-EYE" справжнім польовим інструментом:

* Додати `manifest.json` (дозволить встановлювати сайт як додаток на телефон/планшет).
* Додати `Service Worker` для кешування файлів (html, css, js).
* *Складніше:* Кешування тайлів карти (це можливо, але потребує обережності з лімітами пам'яті браузера).

**2. Безпека API ключа**
У `CONFIG` все ще лежить відкритий API ключ MapTiler.

* Якщо це публічний проект, налаштуйте в кабінеті MapTiler обмеження по **Referrer** (домену), щоб цей ключ не могли використати на інших сайтах.

**3. Модульність (якщо код виросте > 1000 рядків)**
Зараз `app.js` справляється, але якщо ви додасте нові функції (наприклад, малювання полігонів або експорт в GPX), файл стане завеликим. Можна буде подумати про розбиття на ES6 модулі (`<script type="module">`):

* `map.js`
* `tools.js`
* `ui.js`
* `state.js`
